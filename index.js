(function(){"use strict";function u(t,e,s,a,i,r,n,o){var l=typeof t=="function"?t.options:t;return e&&(l.render=e,l.staticRenderFns=s,l._compiled=!0),{exports:t,options:l}}const h={extends:"k-field",props:{value:{type:[String,Object,null],default:null},empty:{type:String,default:"No event added yet"},showEmpty:{type:Boolean,default:!1},eventName:{type:Boolean,default:!0},endDate:{type:Boolean,default:!0},hoursStart:{type:Boolean,default:!1},hoursEnd:{type:Boolean,default:!1},city:{type:Boolean,default:!0},state:{type:Boolean,default:!0},country:{type:Boolean,default:!0},venue:{type:Boolean,default:!0},url:{type:Boolean,default:!0},details:{type:Boolean,default:!0},labels:{type:Object,default:()=>({eventName:"Name",startDate:"Start Date",endDate:"End Date",hoursStart:"From",hoursEnd:"Until",eventDates:"Dates",eventHours:"Hours",city:"City",state:"State/Region",country:"Country",location:"Location",venue:"Venue",url:"URL",details:"Details"})},preview:{type:Array,default:()=>[]}},data(){return{drawer:!1,saving:!1,form:{eventName:"",startDate:"",endDate:"",hoursStart:"",hoursEnd:"",city:"",state:"",country:"",venue:"",url:"",details:""}}},created(){this.$watch(()=>this.value,t=>{const e={eventName:"",startDate:"",endDate:"",hoursStart:"",hoursEnd:"",city:"",state:"",country:"",venue:"",url:"",details:""};this.form=t&&typeof t=="object"?{...e,...t}:{...e}},{immediate:!0})},computed:{emptyComputed(){return this.empty||"No event"},hasContent(){const t=this.value&&typeof this.value=="object"?this.value:{};return[this.eventName?t.eventName:"",t.startDate,this.endDate?t.endDate:"",this.hoursStart?t.hoursStart:"",this.hoursEnd?t.hoursEnd:"",this.city?t.city:"",this.state?t.state:"",this.country?t.country:"",this.venue?t.venue:"",this.url?t.url:"",this.details?t.details:""].some(s=>!!s&&String(s).trim()!=="")},allowedKeys(){return["eventName","startDate","endDate","hoursStart","hoursEnd","eventDates","eventHours","city","state","country","location","venue","url","details"]},summaryOrder(){return Array.isArray(this.preview)&&this.preview.length?this.preview.filter(t=>this.allowedKeys.includes(t)):[...this.eventName?["eventName"]:[],"startDate",...this.endDate?["endDate"]:[],...this.hoursStart?["hoursStart"]:[],...this.hoursEnd?["hoursEnd"]:[],...this.city?["city"]:[],...this.state?["state"]:[],...this.country?["country"]:[],...this.venue?["venue"]:[],...this.url?["url"]:[],...this.details?["details"]:[]]},summaryRows(){const t=this.value&&typeof this.value=="object"?this.value:{},e=[];for(const s of this.summaryOrder){const a=t[s]??"";let i="";if(s==="eventDates"){const n=this.formatPrettyDate(t.startDate||""),o=this.formatPrettyDate(t.endDate||"");i=n&&o?`${n} – ${o}`:n||o||""}else if(s==="eventHours"){const n=this.formatTime(t.hoursStart||""),o=this.formatTime(t.hoursEnd||"");i=n&&o?`${n} – ${o}`:n||o||""}else s==="location"?i=this.formatLocation(t.city,t.state,t.country):s==="startDate"||s==="endDate"?i=this.formatPrettyDate(a):s==="hoursStart"||s==="hoursEnd"?i=this.formatTime(a):i=a;const r=!i||String(i).trim()==="";!this.showEmpty&&r||e.push({key:s,label:this.labels[s]||s,value:i})}return e}},methods:{openDrawer(){const t=[],e=r=>r<=1?"1/1":r===2?"1/2":r===3?"1/3":"1/4",s=1+(this.endDate?1:0)+(this.hoursStart?1:0)+(this.hoursEnd?1:0),a=e(s);this.eventName&&t.push(["eventName",{type:"text",label:this.labels.eventName,width:"1/1"}]),t.push(["startDate",{type:"date",label:this.endDate?this.labels.startDate:"Date",display:"YYYY-MM-DD",time:!1,required:!0,width:a}]),this.endDate&&t.push(["endDate",{type:"date",label:this.labels.endDate,display:"YYYY-MM-DD",time:!1,width:a}]),this.hoursStart&&t.push(["hoursStart",{type:"time",label:this.labels.hoursStart,display:"hh:mm a",notation:24,width:a,step:15}]),this.hoursEnd&&t.push(["hoursEnd",{type:"time",label:this.labels.hoursEnd,display:"hh:mm a",notation:24,width:a,step:15}]),this.city&&t.push(["city",{type:"text",label:this.labels.city,width:this.country?"1/3":"1/2"}]),this.state&&t.push(["state",{type:"text",label:this.labels.state,width:this.country?"1/3":"1/2"}]),this.country&&t.push(["country",{type:"text",label:this.labels.country,width:"1/3"}]),this.venue&&t.push(["venue",{type:"text",label:this.labels.venue}]),this.url&&t.push(["url",{type:"url",label:this.labels.url}]),this.details&&t.push(["details",{type:"textarea",label:this.labels.details,buttons:!1,size:"small"}]);const i=Object.fromEntries(t);this.$panel.drawer.open({component:"k-form-drawer",props:{icon:"calendar",title:"Event Details",fields:i,value:{...this.form}},on:{submit:this.handleSubmit.bind(this)}})},closeDrawer(){this.$panel.drawer.close()},handleSubmit(t){Promise.resolve().then(()=>{this.form={...this.form,...t||{}},this.$emit("input",this.form),this.$emit("change",this.form),this.closeDrawer(),this.$panel.notification.success({message:"Ok",timeout:4e3})}).catch(()=>{this.$panel.notification.error({message:"An error occurred",timeout:4e3})})},formatDate(t){return t?String(t).trim().split(/[ T]/)[0]:""},formatPrettyDate(t){if(!t)return"";const e=String(t).trim(),[s]=e.split(" "),a=s.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!a)return s||e;const i=parseInt(a[1],10),r=parseInt(a[2],10),n=parseInt(a[3],10),o=new Date(Date.UTC(i,r-1,n));return new Intl.DateTimeFormat(void 0,{timeZone:"UTC",month:"short",day:"2-digit",year:"numeric"}).format(o)},formatTime(t){if(!t)return"";const e=String(t).trim(),s=e.match(/^(\d{1,2}):(\d{2})(?::\d{2})?$/);if(!s)return e;let a=parseInt(s[1],10);const i=s[2],r=a>=12?"pm":"am";return a=a%12,a===0&&(a=12),`${a}:${i} ${r}`},formatLocation(t,e,s){return[t,e,s].map(i=>i==null?"":String(i).trim()).filter(Boolean).join(", ")}}};var d=function(){var e=this,s=e._self._c;return s("k-field",e._b({staticClass:"k-event-field"},"k-field",e.$props,!1),[s("k-button",{attrs:{slot:"options",icon:"edit",size:"xs",variant:"filled",disabled:e.disabled},on:{click:e.openDrawer},slot:"options"},[e._v("Edit...")]),s("div",{staticClass:"k-event-field__summary"},[e.hasContent?s("table",{staticClass:"k-table",staticStyle:{"table-layout":"auto"},on:{click:e.openDrawer}},[s("tbody",e._l(e.summaryRows,function(a){return s("tr",{key:a.key},[s("th",{attrs:{"data-mobile":"true"}},[e._v(e._s(a.label))]),s("td",{attrs:{"data-mobile":"true"}},[s("div",{staticClass:"clip"},[a.key==="url"&&a.value?[s("a",{attrs:{href:a.value,target:"_blank",rel:"noopener noreferrer"}},[e._v(e._s(a.value))])]:a.key==="details"&&a.value?[s("div",{staticClass:"k-prose",domProps:{innerHTML:e._s(a.value)}})]:[e._v(" "+e._s(a.value||"—")+" ")]],2)])])}),0)]):s("k-empty",{attrs:{icon:"calendar"}},[e._v(e._s(e.emptyComputed))])],1)],1)},c=[],m=u(h,d,c);const f=m.exports;panel.plugin("scottboms/events",{fields:{event:f}})})();
