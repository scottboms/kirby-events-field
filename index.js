(function(){"use strict";function n(e,t,a,s,l,c,m,p){var i=typeof e=="function"?e.options:e;return t&&(i.render=t,i.staticRenderFns=a,i._compiled=!0),{exports:e,options:i}}const r={extends:"k-field",props:{value:{type:[String,Object,null],default:null},empty:{type:String,default:"No event added yet"},showEmpty:{type:Boolean,default:!1},eventName:{type:Boolean,default:!0},endDate:{type:Boolean,default:!0},venue:{type:Boolean,default:!0},url:{type:Boolean,default:!0},details:{type:Boolean,default:!0},time:{type:Boolean,default:!0},labels:{type:Object,default:()=>({eventName:"Name",startDate:"Start Date",endDate:"End Date",city:"City",state:"State/Region",country:"Country",venue:"Venue",url:"URL",details:"Details"})},preview:{type:Array,default:()=>[]}},data(){return{drawer:!1,saving:!1,form:{eventName:"",startDate:"",endDate:"",city:"",state:"",country:"",venue:"",url:"",details:""}}},created(){this.$watch(()=>this.value,e=>{const t={eventName:"",startDate:"",endDate:"",city:"",state:"",country:"",venue:"",url:"",details:""};this.form=e&&typeof e=="object"?{...t,...e}:{...t}},{immediate:!0})},computed:{emptyComputed(){return this.empty||"No event"},hasContent(){const e=this.value&&typeof this.value=="object"?this.value:{};return[this.eventName?e.eventName:"",e.startDate,this.endDate?e.endDate:"",e.city,e.state,e.country,this.venue?e.venue:"",this.url?e.url:"",this.details?e.details:""].some(a=>!!a&&String(a).trim()!=="")},allowedKeys(){return["eventName","startDate","endDate","city","state","country","venue","url","details"]},summaryOrder(){return Array.isArray(this.preview)&&this.preview.length?this.preview.filter(e=>this.allowedKeys.includes(e)):[...this.eventName?["eventName"]:[],"startDate",...this.endDate?["endDate"]:[],"city","state","country",...this.venue?["venue"]:[],...this.url?["url"]:[],...this.details?["details"]:[]]},summaryRows(){const e=this.value&&typeof this.value=="object"?this.value:{},t=[];for(const a of this.summaryOrder){let s=e[a]??"";(a==="startDate"||a==="endDate")&&(s=this.formatDate(s));const l=!s||String(s).trim()==="";!this.showEmpty&&l||t.push({key:a,label:this.labels[a]||a,value:s})}return t}},methods:{openDrawer(){const e=[];this.eventName&&e.push(["eventName",{type:"text",label:this.labels.eventName,width:"1/1"}]),e.push(["startDate",{type:"date",label:this.labels.startDate,display:"YYYY-MM-DD",time:this.time,width:this.endDate?"1/2":"1/1"}]),this.endDate&&e.push(["endDate",{type:"date",label:this.labels.endDate,display:"YYYY-MM-DD",time:this.time,width:"1/2"}]),e.push(["city",{type:"text",label:this.labels.city,width:"1/3"}]),e.push(["state",{type:"text",label:this.labels.state,width:"1/3"}]),e.push(["country",{type:"text",label:this.labels.country,width:"1/3"}]),this.venue&&e.push(["venue",{type:"text",label:this.labels.venue}]),this.url&&e.push(["url",{type:"url",label:this.labels.url}]),this.details&&e.push(["details",{type:"textarea",label:this.labels.details,buttons:!1,size:"medium"}]);const t=Object.fromEntries(e);this.$panel.drawer.open({component:"k-form-drawer",props:{icon:"calendar",title:"Event Details",fields:t,value:{...this.form}},on:{submit:this.handleSubmit.bind(this)}})},closeDrawer(){this.$panel.drawer.close()},handleSubmit(e){Promise.resolve().then(()=>{this.form={...this.form,...e||{}},this.$emit("input",this.form),this.$emit("change",this.form),this.closeDrawer(),this.$panel.notification.success({message:"Ok",timeout:4e3})}).catch(()=>{this.$panel.notification.error({message:"An error occurred",timeout:4e3})})},formatDate(e){if(!e)return"";const t=String(e);return this.time?t:t.split(/[ T]/)[0]}}};var o=function(){var t=this,a=t._self._c;return a("k-field",t._b({staticClass:"k-event-field"},"k-field",t.$props,!1),[a("k-button",{attrs:{slot:"options",icon:"edit",size:"xs",variant:"filled",disabled:t.disabled},on:{click:t.openDrawer},slot:"options"},[t._v("Edit...")]),a("div",{staticClass:"k-event-field__summary"},[t.hasContent?a("table",{staticClass:"k-table",staticStyle:{"table-layout":"auto"},on:{click:t.openDrawer}},[a("tbody",t._l(t.summaryRows,function(s){return a("tr",{key:s.key},[a("th",{attrs:{"data-mobile":"true"}},[t._v(t._s(s.label))]),a("td",{attrs:{"data-mobile":"true"}},[a("div",{staticClass:"clip"},[s.key==="url"&&s.value?[a("a",{attrs:{href:s.value,target:"_blank",rel:"noopener noreferrer"}},[t._v(t._s(s.value))])]:s.key==="details"&&s.value?[a("div",{staticClass:"k-prose",domProps:{innerHTML:t._s(s.value)}})]:[t._v(" "+t._s(s.value||"â€”")+" ")]],2)])])}),0)]):a("k-empty",{attrs:{icon:"calendar"}},[t._v(t._s(t.emptyComputed))])],1)],1)},u=[],d=n(r,o,u);const h=d.exports;panel.plugin("scottboms/events",{fields:{event:h}})})();
