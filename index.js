(function(){"use strict";function d(t,e,a,s,i,n,o,l){var r=typeof t=="function"?t.options:t;return e&&(r.render=e,r.staticRenderFns=a,r._compiled=!0),{exports:t,options:r}}const m={extends:"k-field",props:{value:{type:[String,Object,null],default:null},empty:{type:String,default:"No event added yet"},showEmpty:{type:Boolean,default:!1},eventName:{type:Boolean,default:!0},endDate:{type:Boolean,default:!0},timeStart:{type:Boolean,default:!1},timeEnd:{type:Boolean,default:!1},city:{type:Boolean,default:!0},state:{type:Boolean,default:!0},country:{type:Boolean,default:!0},venue:{type:Boolean,default:!0},url:{type:Boolean,default:!0},details:{type:Boolean,default:!0},labels:{type:Object,default:()=>({eventName:"Name",date:"Date",startDate:"Start Date",endDate:"End Date",timeStart:"From",timeEnd:"Until",eventDates:"Dates",eventTime:"Time",city:"City",state:"State/Region",country:"Country",location:"Location",venue:"Venue",url:"URL",details:"Details"})},preview:{type:Array,default:()=>[]}},data(){return{drawer:!1,saving:!1,form:{eventName:"",startDate:"",endDate:"",timeStart:"",timeEnd:"",city:"",state:"",country:"",venue:"",url:"",details:""}}},created(){this.$watch(()=>this.value,t=>{const e={eventName:"",startDate:"",endDate:"",timeStart:"",timeEnd:"",city:"",state:"",country:"",venue:"",url:"",details:""};this.form=t&&typeof t=="object"?{...e,...t}:{...e}},{immediate:!0})},computed:{emptyComputed(){return this.empty||"No event"},hasContent(){const t=this.value&&typeof this.value=="object"?this.value:{};return[this.eventName?t.eventName:"",t.startDate,this.endDate?t.endDate:"",this.timeStart?t.timeStart:"",this.timeEnd?t.timeEnd:"",this.city?t.city:"",this.state?t.state:"",this.country?t.country:"",this.venue?t.venue:"",this.url?t.url:"",this.details?t.details:""].some(a=>!!a&&String(a).trim()!=="")},allowedKeys(){return["eventName","startDate","endDate","timeStart","timeEnd","eventDates","eventTime","city","state","country","location","venue","url","details"]},summaryOrder(){const t=this.allowedKeys;if(Array.isArray(this.preview)&&this.preview.length){let e=this.preview.filter(n=>t.includes(n));this.endDate||(e=e.filter(n=>n!=="endDate"));const a=e.indexOf("startDate"),s=e.indexOf("endDate");if(!e.includes("eventDates")&&(a!==-1||s!==-1)){const n=Math.min(a!==-1?a:1/0,s!==-1?s:1/0);e=e.filter(o=>o!=="startDate"&&o!=="endDate"),e.splice(n===1/0?e.length:n,0,"eventDates")}return e}return[...this.eventName?["eventName"]:[],"eventDates",...this.timeStart?["timeStart"]:[],...this.timeEnd?["timeEnd"]:[],...this.city?["city"]:[],...this.state?["state"]:[],...this.country?["country"]:[],...this.venue?["venue"]:[],...this.url?["url"]:[],...this.details?["details"]:[]]},summaryRows(){const t=this.value&&typeof this.value=="object"?this.value:{},e=[];for(const a of this.summaryOrder){const s=t[a]??"";let i="",n=this.labels[a]||a;if(a==="eventDates"){const l=this.formatPrettyDate(t.startDate||""),r=this.endDate?this.formatPrettyDate(t.endDate||""):"";i=l&&r?`${l} – ${r}`:l||r||"",n=this.endDate?this.labels.eventDates||"Dates":this.labels.date||"Date"}else if(a==="eventTime"){const l=this.formatTime(t.timeStart||""),r=this.timeEnd?this.formatTime(t.timeEnd||""):"";i=l&&r?`${l} – ${r}`:l||r||""}else a==="location"?i=this.formatLocation(t.city,t.state,t.country):a==="startDate"||a==="endDate"?i=this.formatPrettyDate(s):a==="timeStart"||a==="timeEnd"?i=this.formatTime(s):i=s;const o=!i||String(i).trim()==="";!this.showEmpty&&o||e.push({key:a,label:n,value:i})}return e}},methods:{openDrawer(){const t=[],e=n=>n<=1?"1/1":n===2?"1/2":n===3?"1/3":"1/4",a=1+(this.endDate?1:0)+(this.timeStart?1:0)+(this.timeEnd?1:0),s=e(a);this.eventName&&t.push(["eventName",{type:"text",label:this.labels.eventName,width:"1/1"}]),t.push(["startDate",{type:"date",label:this.endDate?this.labels.startDate:"Date",display:"YYYY-MM-DD",time:!1,required:!0,width:s}]),this.endDate&&t.push(["endDate",{type:"date",label:this.labels.endDate,display:"YYYY-MM-DD",time:!1,width:s}]),this.timeStart&&t.push(["timeStart",{type:"time",label:this.labels.timeStart,display:"hh:mm a",notation:24,width:s,step:15}]),this.timeEnd&&t.push(["timeEnd",{type:"time",label:this.labels.timeEnd,display:"hh:mm a",notation:24,width:s,step:15}]),this.city&&t.push(["city",{type:"text",label:this.labels.city,width:this.country?"1/3":"1/2"}]),this.state&&t.push(["state",{type:"text",label:this.labels.state,width:this.country?"1/3":"1/2"}]),this.country&&t.push(["country",{type:"text",label:this.labels.country,width:"1/3"}]),this.venue&&t.push(["venue",{type:"text",label:this.labels.venue}]),this.url&&t.push(["url",{type:"url",label:this.labels.url}]),this.details&&t.push(["details",{type:"textarea",label:this.labels.details,buttons:!1,size:"small"}]);const i=Object.fromEntries(t);this.$panel.drawer.open({component:"k-form-drawer",props:{icon:"calendar",title:"Event Details",fields:i,value:{...this.form}},on:{submit:this.handleSubmit.bind(this)}})},closeDrawer(){this.$panel.drawer.close()},handleSubmit(t){Promise.resolve().then(()=>{this.form={...this.form,...t||{}},this.$emit("input",this.form),this.$emit("change",this.form),this.closeDrawer(),this.$panel.notification.success({message:"Ok",timeout:4e3})}).catch(()=>{this.$panel.notification.error({message:"An error occurred",timeout:4e3})})},formatDate(t){return t?String(t).trim().split(/[ T]/)[0]:""},formatPrettyDate(t){if(!t)return"";const e=String(t).trim(),[a]=e.split(" "),s=a.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!s)return a||e;const i=parseInt(s[1],10),n=parseInt(s[2],10),o=parseInt(s[3],10),l=new Date(Date.UTC(i,n-1,o));return new Intl.DateTimeFormat(void 0,{timeZone:"UTC",month:"short",day:"2-digit",year:"numeric"}).format(l)},formatTime(t){if(!t)return"";const e=String(t).trim(),a=e.match(/^(\d{1,2}):(\d{2})(?::\d{2})?$/);if(!a)return e;let s=parseInt(a[1],10);const i=a[2],n=s>=12?"pm":"am";return s=s%12,s===0&&(s=12),`${s}:${i} ${n}`},formatLocation(t,e,a){return[t,e,a].map(i=>i==null?"":String(i).trim()).filter(Boolean).join(", ")}}};var u=function(){var e=this,a=e._self._c;return a("k-field",e._b({staticClass:"k-event-field"},"k-field",e.$props,!1),[a("k-button",{attrs:{slot:"options",icon:"edit",size:"xs",variant:"filled",disabled:e.disabled},on:{click:e.openDrawer},slot:"options"},[e._v("Edit...")]),a("div",{staticClass:"k-event-field__summary"},[e.hasContent?a("table",{staticClass:"k-table",staticStyle:{"table-layout":"auto"},on:{click:e.openDrawer}},[a("tbody",e._l(e.summaryRows,function(s){return a("tr",{key:s.key},[a("th",{attrs:{"data-mobile":"true"}},[e._v(e._s(s.label))]),a("td",{attrs:{"data-mobile":"true"}},[a("div",{staticClass:"clip"},[s.key==="url"&&s.value?[a("a",{attrs:{href:s.value,target:"_blank",rel:"noopener noreferrer"}},[e._v(e._s(s.value))])]:s.key==="details"&&s.value?[a("div",{staticClass:"k-prose",domProps:{innerHTML:e._s(s.value)}})]:[e._v(" "+e._s(s.value||"—")+" ")]],2)])])}),0)]):a("k-empty",{attrs:{icon:"calendar"}},[e._v(e._s(e.emptyComputed))])],1)],1)},h=[],c=d(m,u,h);const f=c.exports;panel.plugin("scottboms/events",{fields:{event:f}})})();
